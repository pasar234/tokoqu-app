<!DOCTYPE html>
<html lang="id" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aplikasi manajemen stok produk NARITA, VR, KUDUS, LAIN">
    <title>Stok Pintar - Manajemen Stok</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    
    <style>
        /* Efek khusus untuk aplikasi */
        .harga-value {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .harga-value:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .harga-value.jual {
            animation: pulse-red 2s infinite;
        }
        
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.4); }
            70% { box-shadow: 0 0 0 6px rgba(220, 38, 38, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
        }
        
        .product-card {
            transition: all 0.3s ease;
        }
        
        .stock-value.changed {
            animation: stockChange 0.5s ease;
        }
        
        @keyframes stockChange {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1>
                    <i class="fas fa-boxes"></i>
                    Stok Pintar
                </h1>
                <p class="app-subtitle">Manajemen Stok Produk</p>
            </div>
            <div class="app-actions">
                <button class="btn-icon" id="themeToggle" title="Ganti tema">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="btn-icon" id="installBtn" style="display: none;" title="Install aplikasi">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="main-nav">
            <div class="nav-container">
                <button class="nav-btn active" data-page="home" title="Halaman utama">
                    <i class="fas fa-home"></i>
                    Home
                </button>
                <button class="nav-btn" data-page="narita" title="Produk Narita">
                    <i class="fas fa-tag"></i>
                    NARITA
                </button>
                <button class="nav-btn" data-page="vr" title="Produk VR">
                    <i class="fas fa-tag"></i>
                    VR
                </button>
                <button class="nav-btn" data-page="kudus" title="Produk Kudus">
                    <i class="fas fa-tag"></i>
                    KUDUS
                </button>
                <button class="nav-btn" data-page="lain" title="Produk Lainnya">
                    <i class="fas fa-tag"></i>
                    LAIN
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Page -->
            <div class="page active" id="page-home">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-plus-circle"></i> Tambah Produk Baru</h2>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label for="nama">Nama Produk *</label>
                            <input type="text" id="nama" class="form-input" placeholder="Contoh: Bodi Supra" required autofocus>
                        </div>
                        <div class="form-group">
                            <label for="kode">Kode Produk</label>
                            <input type="text" id="kode" class="form-input" placeholder="Opsional, contoh: BS-001">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="beli">Harga Beli (Rp)</label>
                                <input type="number" id="beli" class="form-input" placeholder="0" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label for="jual">Harga Jual (Rp) *</label>
                                <input type="number" id="jual" class="form-input" placeholder="Contoh: 25000" min="0" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="kategori">Kategori</label>
                            <select id="kategori" class="form-select">
                                <option value="narita">NARITA</option>
                                <option value="vr">VR</option>
                                <option value="kudus">KUDUS</option>
                                <option value="lain">LAIN</option>
                            </select>
                        </div>
                        <button class="btn-primary btn-block" id="simpanProduk">
                            <i class="fas fa-save"></i> Simpan Produk
                        </button>
                        <p class="info-text">
                            <i class="fas fa-keyboard"></i>
                            Tekan <kbd>Enter</kbd> untuk simpan cepat
                        </p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-database"></i> Kelola Data</h2>
                    </div>
                    <div class="card-body">
                        <button class="btn-secondary btn-block" id="backupBtn">
                            <i class="fas fa-file-export"></i> Backup Data (.json)
                        </button>
                        <div class="file-upload-wrapper">
                            <label for="fileInput" class="btn-outline btn-block">
                                <i class="fas fa-file-import"></i> Restore Data
                                <input type="file" id="fileInput" class="file-input" accept=".json">
                            </label>
                        </div>
                        <button class="btn-warning btn-block" id="clearDataBtn" style="margin-top: 10px;">
                            <i class="fas fa-trash-alt"></i> Hapus Semua Data
                        </button>
                        <p class="info-text">
                            <i class="fas fa-info-circle"></i>
                            Backup data secara berkala untuk keamanan
                        </p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-bar"></i> Statistik</h2>
                    </div>
                    <div class="card-body">
                        <div class="stats-grid" id="statsContainer">
                            <!-- Statistik akan diisi oleh JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- List Page (NARITA/VR/KUDUS/LAIN) -->
            <div class="page" id="page-list">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-search"></i> Cari Produk</h2>
                    </div>
                    <div class="card-body">
                        <div class="search-container">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" id="cari" class="search-input" 
                                   placeholder="Cari nama atau kode produk..." 
                                   autocomplete="off">
                            <button class="btn-icon" id="clearSearch" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); display: none;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h2 id="categoryTitle">Daftar Produk</h2>
                            <span class="badge" id="productCount">0 produk</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Empty State -->
                        <div class="empty-state" id="emptyState">
                            <i class="fas fa-box-open"></i>
                            <h3>Belum ada produk</h3>
                            <p>Tambahkan produk baru di halaman Home</p>
                        </div>

                        <!-- Products List -->
                        <div id="list-container"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h2 id="confirmTitle">Konfirmasi</h2>
            <p id="confirmMessage">Apakah Anda yakin?</p>
            <div class="modal-actions">
                <button class="btn-outline" id="confirmCancel">Batal</button>
                <button class="btn-danger" id="confirmOk">Ya, Lanjutkan</button>
            </div>
        </div>
    </div>

    <!-- Edit Price Modal -->
    <div class="modal" id="editPriceModal">
        <div class="modal-content">
            <h2><i class="fas fa-edit"></i> Edit Harga Produk</h2>
            <p id="editProductName">Nama Produk</p>
            
            <div class="form-group">
                <label for="editHargaBeli">Harga Beli (Rp)</label>
                <input type="number" id="editHargaBeli" class="form-input" min="0" placeholder="Harga beli">
            </div>
            
            <div class="form-group">
                <label for="editHargaJual">Harga Jual (Rp) *</label>
                <input type="number" id="editHargaJual" class="form-input" min="0" placeholder="Harga jual" required>
            </div>
            
            <div class="modal-actions">
                <button class="btn-outline" id="cancelEditBtn">Batal</button>
                <button class="btn-primary" id="saveEditBtn">Simpan Perubahan</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <script src="app.js"></script>
    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js')
                    .then(function(registration) {
                        console.log('‚úÖ ServiceWorker terdaftar dengan scope:', registration.scope);
                    })
                    .catch(function(err) {
                        console.log('‚ùå ServiceWorker gagal:', err);
                    });
            });
        }
        
        // Detect if running as PWA
        window.addEventListener('load', function() {
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('üì± Running as PWA');
                document.title = 'Stok Pintar';
            }
        });
    </script>
</body>
</html>
